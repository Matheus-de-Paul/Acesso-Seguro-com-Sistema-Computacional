from ultralytics import YOLO
from PIL import Image
import requests
from io import BytesIO

# ğŸ”¹ Carrega seu primeiro modelo treinado
model = YOLO(r"C:\Users\pedro\Desktop\EPI_detection\runs\detect\treino_epi_yolo11x3\weights\best.pt")  # caminho do modelo

# ğŸ”¹ URL da imagem que vocÃª quer testar
image_url = "https://www.danny.com.br/public/files/xycGd7LatSHeHYXcshw99IxMzK2iMNZdgBbHLCyZ.png"

# ğŸ”¹ Baixa a imagem em memÃ³ria
response = requests.get(image_url)
img = Image.open(BytesIO(response.content)).convert("RGB")

# ğŸ”¹ Faz a inferÃªncia com o primeiro modelo
results = model(img)  # results Ã© uma lista

# ğŸ”¹ Mostra o resultado do primeiro modelo
results[0].show()  # acessa o primeiro item da lista

# ğŸ”¹ Acessa os dados das detecÃ§Ãµes do primeiro modelo
r = results[0]
print("Modelo 1:")
print("Caixas:", r.boxes.xyxy)   # coordenadas [x1, y1, x2, y2]
print("ConfianÃ§a:", r.boxes.conf) # confianÃ§a de cada detecÃ§Ã£o
print("Classes:", r.boxes.cls)    # classe detectada
